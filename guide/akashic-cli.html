<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162208211-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162208211-1');
</script>

<meta charset="UTF-8">
<meta name="viewport"    content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover">
<meta name="description" content="Akashic Engine là một công cụ phát triển trò chơi đa nền tảng miễn phí sử dụng, chạy trên JavaScript.">
<meta name="theme-color" content="#0F1F26">
<title>Hướng dẫn sử dụng akashic-cli</title>
<link rel="icon"       href="/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="stylesheet" href="/css/common.css?8311d7d">
<link rel="stylesheet" href="/css/header.css?8311d7d">
<link rel="stylesheet" href="/css/footer.css?8311d7d">


<link rel="stylesheet" href="/css/asset.css?8311d7d">

<link rel="stylesheet" href="/css/akashic-document.css?8311d7d">

<link rel="stylesheet" href="/css/railscasts.css?8311d7d">


<script src="/lib/jquery-3.2.1.min.js"></script>
<script src="/lib/common.js?8311d7d"></script>


<script src="/lib/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

<div class="head--spacer"></div>
<div class="SP--head--menu--show"></div>
<div class="SP--head--menu--hide"></div>

<div class="head--menu--outer">
	<ul class="head--menu">
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/tutorial/v2/">Giới thiệu về Akashic Engine</a></li>
				<li><a href="/shin-ichiba/">Hãy tạo một "trò chơi trực tiếp" Nico</a></li>
				<!--li><a href="/tutorial/akashic-info.html">Akashic Engine関連情報一覧</a></li-->
			</ul>
		</li>
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/guide/akashic-cli.html">hướng dẫn sử dụng akashic-cli</a></li>
				<li><a href="/guide/game-json.html">thông số kỹ thuật game.json</a></li>
				<li><a href="/guide/asset-recommended-spec.html">Thông số kỹ thuật vật liệu được đề xuất</a></li>
				<li><a href="/guide/composite-operation.html">Sử dụng CompositeOperation</a></li>
				<li><a href="/guide/storage.html">về lưu trữ</a></li>
				<li><a href="/guide/asset-load-error.html">Về lỗi tải nội dung</a></li>
				<li><a href="/guide/atsumaru.html">Hướng dẫn đăng RPG Atsmar</a></li>
				<li><a href="/guide/template-guide.html">hướng dẫn sử dụng mẫu akashic init</a></li>
				<li><a href="/guide/shader.html">Sử dụng shader</a></li>
				<li><a href="/guide/shin-ichiba/index.html">Tạo một trò chơi có thể chơi trực tiếp trên NicoNico</a></li>
				<li><a href="/guide/sandbox-config.html">Thông số kỹ thuật của sandbox.config.js</a></li>
				<li><a href="/guide/bmpfont-generator.html">Thông số kỹ thuật của bmpfont-generator</a></li>
				<li><a href="/guide/common-pitfalls.html">Common pitfalls</a></li>
			</ul>
		</li>
		<li class="head--menu--item"><a class="head--logo" href="/" title="Trang Chủ"></a></li>
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/reference/akashic-engine-v1/modules/_lib_main_d_.g.html">akashic-engine v1.x(không dùng nữa)</a></li>
				<li><a href="/reference/akashic-engine-v2/modules/_lib_main_d_.g.html">akashic-engine v2.x</a></li>
				<li><a href="/reference/akashic-timeline/">akashic-timeline</a></li>
				<li><a href="/reference/akashic-animation/">akashic-animation</a></li>
				<li><a href="/reference/akashic-label/">akashic-label</a></li>
				<li><a href="/reference/akashic-tile/">akashic-tile</a></li>
				<li><a href="/reference/akashic-box2d/">akashic-box2d</a></li>
				<li><a href="/reference/coe/">coe framework</a></li>
				<li><a href="/reference/raycaster-js/">raycaster-js</a></li>
			</ul>
		</li>
		<li class="head--menu--item">
			<p class="head--menu--item--tab"></p>
			<ul class="head--menu--item--list">
				<li><a href="/demo/?title=helloworld">Hello World</a></li>
				<li><a href="/demo/?title=scale-rotate-opacity">Scale / Rotation / Transparency</a></li>
				<li><a href="/demo/?title=bitmap-font">Bitmap font</a></li>
				<li><a href="/demo/?title=framesprite">Frame animation</a></li>
				<li><a href="/demo/?title=demo-touchevent">Touch event</a></li>
				<li><a href="/demo/?title=demo-tile">Tile</a></li>
				<li><a href="/demo/?title=label-sample">Label</a></li>
				<li><a href="/demo/?title=animation-showcase">Animation control</a></li>
				<li><a href="/demo/?title=timeline-sample">Tween control</a></li>
				<li><a href="/demo/?title=simpleShot">Abstract shooting</a></li>
				<li><a href="/demo/?title=HoppingWitch">HOPPING WITCH</a></li>
				<li><a href="/demo/?title=GalaxyWars">GALAXY WARS</a></li>
				<li><a href="/demo/?title=cannontv">Đi nào! Siêu hội nghị</a></li>
				<li><a href="/asset/material.html">Tài liệu demo mẫu</a></li>
			</ul>
		</li>
	</ul>
</div>

<header id="akashic-page-header">
	<div class="SP--head--logo--box"><a class="head--logo" href="/" title="Trang Chủ"></a></div>
</header>

<div id="BodyInner">
	<section class="akashic--document safearea--LR">
		<div class="inner responsive--width">
			<h1>Hướng dẫn sử dụng akashic-cli</h1>
<h2><a name="đây là"></a> đây là</h2>
<p>Giải thích các thông số kỹ thuật và cách sử dụng lệnh akashic, một công cụ dòng lệnh hỗ trợ phát triển trò chơi với Akashic.
	Lệnh akashic có thể được sử dụng bằng cách cài đặt và sử dụng akashic-cli. Phiên bản mục tiêu của akashic-cli được mô tả trong hướng dẫn sử dụng này là 1.0.8 trở lên.</p>
<p>Cơ thể xiên (italics?) đang được xem xét.</p>
<h2><a name="Cài đặt thế nào"></a> Cài đặt thế nào</h2>
<p>Lệnh akashic hoạt động trong môi trường Node.js. Cài đặt Node.js trên mỗi nền tảng bằng phương pháp thích hợp. Hướng dẫn sử dụng này giả định phiên bản LTS của môi trường Node.js. Tại thời điểm viết bài, phiên bản LTS là 8.11.3.</p>
<p>Nếu bạn là người dùng Windows hoặc Mac, bạn có thể tải xuống và cài đặt các gói thích hợp từ <a href="https://nodejs.org/download/"> trang web chính thức của Node.js</a></p>
<pre><code class="language-sh">npm install -g @akashic/akashic-cli</code></pre>
<h2><a name="Cách sử dụng"></a> Cách sử dụng</h2>
<p>Nếu cài đặt thành công, bạn có thể thực hiện các lệnh sau. Khi được thực thi, một trợ giúp ngắn gọn cho lệnh akashic được hiển thị.</p>
<pre><code class="language-sh">$ akashic</code></pre>
<p><code>akashic</code> Có các lệnh sau:</p>
<ul>
<li>akashic init<ul>
<li>Tạo tập lệnh và thư mục hoạt động tối thiểu cho các trò chơi Akashic</li>
</ul>
</li>
<li>akashic modify<ul>
<li>Cập nhật thông tin meta khác nhau của trò chơi được mô tả trong game.json</li>
</ul>
</li>
<li>akashic scan<ul>
<li>Cập nhật nội dung trò chơi và thông tin thư viện khác nhau được mô tả trong game.json</li>
</ul>
</li>
<li>akashic serve<ul>
<li>Khởi động máy chủ kiểm tra hoạt động nhiều người chơi lưu trữ trò chơi Akashic</li>
</ul>
</li>
<li>akashic install<ul>
<li>Thực hiện cài đặt npm (npm install) và thêm danh sách các tệp đã thêm vào game.json</li>
</ul>
</li>
<li>akashic uninstall<ul>
<li>Chạy npm gỡ cài đặt (npm uninstall) để xóa các tệp đã xóa khỏi danh sách trong game.json</li>
</ul>
</li>
<li>akashic update<ul>
<li>Thực hiện cập nhật npm (npm update), cập nhật các gói npm trong <code>node_modules/</code> và thêm bất kỳ thay đổi nào vào tệp vào game.json</li>
</ul>
</li>
<li>akashic export zip<ul>
<li>Chuyển đổi trò chơi sang định dạng zip và xuất ra.</li>
</ul>
</li>
<li>akashic export html<ul>
<li>Tạo thư mục chứa tệp HTML (và hình ảnh, v.v.) cho phép trò chơi chạy độc lập.</li>
</ul>
</li>
<li>akashic stat<ul>
<li>Thu thập và xuất thông tin về trò chơi.</li>
</ul>
</li>
</ul>
<p>Các lệnh khác ngoài init sẽ vận hành, xuất và thực thi game.json do init tạo ra. Do đó, khi phát triển một trò chơi, bạn thường chạy akashic init trước, sau đó chạy các lệnh khác nếu cần.</p>
<h2><a name="init"></a> init</h2>
<pre><code class="language-sh">akashic init [&lt;options&gt;]</code></pre>
<p>Tạo một trò chơi mới chạy trên Akashic trong thư mục hiện tại.</p>
<p>Khi bạn thực hiện lệnh này, giao diện tương tác sau sẽ được hiển thị, và bạn có thể nhập chiều rộng và chiều cao của màn hình trò chơi và FPS của trò chơi.</p>
<pre><code class="language-sh">$ npm install -g @akashic/akashic-cli
$ cd GAME_HOME
$ akashic init
width: (320)
height: (320)
fps: (30)</code></pre>
<p>Ngoài ra, lệnh này có thể bị lỗi nếu thư mục hiện tại không trống. (Nếu thư mục tệp được tạo đã tồn tại, lệnh sẽ không thành công với lỗi)</p>
<p><code>&lt;options&gt;</code> Các tùy chọn có thể được chỉ định như sau:</p>
<table>
<thead>
<tr>
<th align="center">Option</th>
<th align="center">Tên viết tắt</th>
<th align="center">Hiệu ứng</th>
<th align="center">Giá trị mặc định</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>--type &lt;type&gt;</code></td>
<td align="center"><code>-t</code></td>
<td align="center"><code>&lt;type&gt;</code> Một trò chơi sẽ được tạo theo giá trị của. Chi tiết sẽ được mô tả sau.</td>
<td align="center"><code>javascript</code></td>
</tr>
<tr>
<td align="center"><code>--force</code></td>
<td align="center"><code>-f</code></td>
<td align="center">Ngay cả khi thư mục tệp được tạo đã tồn tại, nó sẽ được ghi đè mà không có lỗi.</td>
<td align="center"><code>false</code></td>
</tr>
<tr>
<td align="center"><code>--yes</code></td>
<td align="center"><code>-y</code></td>
<td align="center">Tạo trò chơi với cài đặt mặc định mà không hiển thị giao diện tương tác.</td>
<td align="center"><code>false</code></td>
</tr>
</tbody></table>
<h3><a name="--type option"></a> --type option</h3>
<p>Các giá trị có thể được chỉ định cho &lt;type&gt; như sau. Nếu không được chỉ định, <code>javascript</code> được coi là đã chỉ định.</p>
<ul>
<li><code>javascript</code></li>
<li><code>javascript-minimal</code></li>
<li><code>javascript-shin-ichiba-ranking</code></li>
<li><code>typescript</code></li>
<li><code>typescript-minimal</code></li>
<li><code>typescript-shin-ichiba-ranking</code></li>
</ul>
<h4><a name="javascript"></a> javascript</h4>
<p>Trò chơi được viết bằng JavaScript chứa các tệp thư mục sau sẽ được tạo:</p>
<pre><code>GAME_HOME
 +- image/
 +- text/
 +- audio/
 +- script/
  +- main.js
 +- game.json
 +- package.json</code></pre>
 <p>Bạn có thể tạo một trò chơi bằng cách chỉnh sửa <code>script/main.js</code>. 
Để biết thêm thông tin về các tệp thư mục này, hãy xem <a href="#init%E3%81%A7%E4%BD%9C%E3%82%89%E3%82%8C%E3%82%8B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB">các tệp được tạo bởi init</a> 
Trong trò chơi này, xử lý sau được thực hiện như một mẫu.</p>
<ul>
<li>Hiển thị các sprites</li>
<li>Tạo ra âm thanh</li>
<li>Định nghĩa sự kiện chạm (Touch event)</li>
</ul>
<h4><a name="javascript-minimal"></a> javascript-minimal</h4>
<p>Một trò chơi trống sẽ được tạo mô tả quá trình xử lý tối thiểu.
Bạn có thể tạo một trò chơi bằng cách chỉnh sửa <code>script/main.js</code></p>
<h4><a name="javascript-shin-ichiba-ranking"></a> javascript-shin-ichiba-ranking</h4>
<p>Một mẫu trò chơi "tương ứng với xếp hạng" của trò chơi thô Nico được tạo.
Bạn có thể tạo một trò chơi bằng cách chỉnh sửa <code>script/main.js</code>. Về cơ bản <code>script/_bootstrap.js</code> không cần chỉnh sửa.
Trong trò chơi này, các giá trị sau mới được thêm vào đối số <code>param</code> của hàm <code>main</code> của <code>script/main.js</code></p>
<ul>
<li><code>param.sessionParameter</code>: <a href="/guide/shin-ichiba/shin-ichiba-spec#session-parameter">Session parameters</a></li>
<li><code>param.isAtsumaru</code>:Một giá trị boolean cho biết liệu môi trường mà trò chơi đang chạy có phải trên RPG Atsmar hay không</li>
</ul>
<p>Tham khảo thêm <a href="/guide/shin-ichiba/ranking">tại đây</a> để biết cách làm game "Nico live" có hỗ trợ chế độ xếp hạng (ranking).</p>
<h4><a name="typescript"></a> typescript</h4>
<p>Trò chơi được viết bằng TypeScript và các tệp thư mục cần thiết để xây dựng nó sẽ được tạo.
Bằng cách xây dựng những thứ này, một trò chơi chạy trên Akashic sẽ được tạo trong thư mục "game".
Xem README.md đã tạo để biết cách xây dựng (build)</p>
<p>Nội dung của trò chơi giống như trò chơi được tạo ra khi <code>--type javascript</code> được chỉ định.</p>
<h4><a name="typescript-minimal"></a> typescript-minimal</h4>
<p><code>--type tyepescript</code> Tương tự, một trò chơi được viết bằng TypeScript và các tệp thư mục cần thiết để xây dựng được tạo ra.</p>
<p>Nội dung của trò chơi giống như trò chơi được tạo khi <code>--type javascript-minimal</code> được chỉ định.</p>
<h4><a name="typescript-shin-ichiba-ranking"></a> typescript-shin-ichiba-ranking</h4>
<p><code>--type tyepescript</code> Tương tự, một trò chơi được viết bằng TypeScript và các tệp thư mục cần thiết để xây dựng được tạo ra.</p>
<p>Nội dung của trò chơi giống như trò chơi được tạo khi <code>--type javascript-shin-ichiba-ranking</code> được chỉ định.</p>
<h2><a name="modify"></a> modify</h2>
<pre><code class="language-sh">akashic modify &lt;target&gt;</code></pre>
<p>Cập nhật thông tin meta khác nhau được mô tả trong game.json.
Các chuỗi có thể được chỉ định cho &lt;target&gt; như sau:</p>
<ul>
<li>width &lt;new_width&gt;<ul>
<li>game.json に記述されたゲーム画面の幅を &lt;new_width&gt; の値(数値)で更新します。</li>
</ul>
</li>
<li>height &lt;new_height&gt;<ul>
<li>game.json に記述されたゲーム画面の高さを &lt;new_height&gt; の値(数値)で更新します。</li>
</ul>
</li>
<li>fps &lt;new_fps&gt;<ul>
<li>game.json に記述されたゲーム画面の FPS を &lt;new_fps&gt; の値(数値)で更新します。</li>
</ul>
</li>
</ul>
<h2><a name="scan"></a> scan</h2>
<pre><code class="language-sh">akashic scan &lt;target&gt;</code></pre>
<p>game.json に記述されているゲームのアセットや各種ライブラリ情報を更新します。
&lt;target&gt; に指定できる文字列は以下のとおりです:</p>
<ul>
<li>asset &lt;subtarget&gt;<ul>
<li>game.json に記述されたアセット情報を更新します。(&lt;subtarget&gt; の内容は後述)</li>
</ul>
</li>
<li>globalScripts<ul>
<li>カレントディレクトリの node_modules/ 以下のファイル一覧を game.json に加えます。</li>
<li>通常使用する必要はありません。akashic install や uninstall を利用してください。</li>
</ul>
</li>
</ul>
<p>game.json のアセット情報を更新する scan asset コマンドは、もう一つの引数 &lt;subtarget&gt; によって更新する情報を制御することができます。</p>
<pre><code class="language-sh">akashic scan asset &lt;subtarget&gt;</code></pre>
<p>&lt;subtarget&gt; に指定できる文字列とそれぞれの動作は次のとおりです:</p>
<ul>
<li>image<ul>
<li>image/ ディレクトリ以下の画像素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>text<ul>
<li>text/ ディレクトリ以下のテキスト素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>audio<ul>
<li>audio/ ディレクトリ以下の音素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>script<ul>
<li>script/ ディレクトリ以下のスクリプト素材を列挙し、アセット情報を更新します。</li>
</ul>
</li>
<li>(なし)<ul>
<li>上記すべてを行います。</li>
</ul>
</li>
</ul>
<p>game.json の管理しているアセット情報には、ファイルパスだけでなく以下のような情報も含まれます。素材の増減時だけでなく、これらの変更時にも scan asset コマンドを実行してください。</p>
<ul>
<li>画像素材の幅・高さ</li>
<li>(将来のバージョンにおいて) 音素材の再生時間</li>
</ul>
<p>また scan asset コマンドは新たに追加するアセット定義に対し、type に応じて以下の初期値を与えます。
(値の詳細は<a href="game-json.html">game.json の仕様</a>を参照してください)</p>
<ul>
<li>&quot;type&quot;: &quot;script&quot;<ul>
<li>&quot;global&quot;: true</li>
</ul>
</li>
<li>&quot;type&quot;: &quot;audio&quot;<ul>
<li>&quot;systemId&quot;: &quot;sound&quot;</li>
</ul>
</li>
</ul>
<p>scan asset コマンドによる素材の列挙は、ディレクトリを再帰的に検索します。つまり、image/ のサブディレクトリに置かれた画像素材なども、列挙されアセット情報に登録されます。</p>
<p>各素材をアセットとして使用するには、アセットを識別する ID (アセット ID) が必要になります。
scan asset コマンドは、デフォルトでアセット ID として「ファイル名から拡張子を取り除いたもの」を設定します。
(audio/title.ogg と script/title.js は、同じ &quot;title&quot; という ID となって衝突し、エラーになります。これを回避するには後述する <code>--use-path-asset-id</code> オプションを利用してください。)
このとき、ファイル名は以下の条件を全て満たす必要があります。</p>
<ul>
<li>半角英数字、アンダースコア &quot;_&quot;、ドル記号 &quot;$&quot; のみで構成されている</li>
<li>英字で始まっている</li>
</ul>
<p>ユーザは game.json を直接編集して、アセット ID を任意に変更することができます。
akashic コマンドはファイルパスを基準に操作を行うため、たとえば画像素材の ID を変更した後にその画像のサイズを変更しても、適切に game.json の幅・高さ情報を更新します。</p>
<p><code>--use-path-asset-id</code> オプションを指定することで、 game.json があるディレクトリからの (拡張子を含めた) アセットの相対パスを ID にすることができます。
同名ファイルのアセットが複数存在するケースで利用することができます。
(このオプション利用時は上記のファイル名制限が無視されます。)</p>
<pre><code class="language-sh">akashic scan asset &lt;subtarget&gt; --use-path-asset-id</code></pre>
<p>また <code>--update-asset-id</code> オプションを併用することで、すでに登録されているアセット ID を相対パスに変更することができます。</p>
<pre><code class="language-sh">akashic scan asset &lt;subtarget&gt; --use-path-asset-id --update-asset-id</code></pre>
<h2><a name="serve"></a> serve</h2>
<pre><code class="language-sh">akashic serve [&lt;options&gt;] [&lt;path&gt;]</code></pre>
<p><code>&lt;path&gt;</code> ディレクトリ(省略時はカレントディレクトリ)にあるゲームをホストする、マルチプレイ動作確認用サーバを起動します。</p>
<p>起動後に表示される URL(デフォルトでは <code>http://localhost:3300/</code>)を Web ブラウザで開いてください。</p>
<p><code>&lt;options&gt;</code> に指定可能なオプションは次のとおりです。</p>
<table>
<thead>
<tr>
<th align="center">オプション</th>
<th align="center">短縮名</th>
<th align="center">効果</th>
<th align="center">デフォルト値</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>--hostname &lt;hostname&gt;</code></td>
<td align="center"><code>-H</code></td>
<td align="center">起動するサーバのホスト名を指定します。</td>
<td align="center"><code>localhost</code></td>
</tr>
<tr>
<td align="center"><code>--port &lt;port&gt;</code></td>
<td align="center"><code>-p</code></td>
<td align="center">起動するサーバのポート番号を指定します。</td>
<td align="center"><code>3300</code></td>
</tr>
<tr>
<td align="center"><code>--target-service &lt;name&gt;</code></td>
<td align="center"><code>-s</code></td>
<td align="center">指定されたサービスの挙動を模擬します。(後述)</td>
<td align="center"><code>none</code></td>
</tr>
<tr>
<td align="center"><code>--verbose</code></td>
<td align="center"><code>-v</code></td>
<td align="center">詳細情報をログ出力します。</td>
<td align="center"><code>false</code></td>
</tr>
</tbody></table>
<p>ネットワークごしに(他の PC などから)マルチプレイを行いたい場合は、 <code>--hostname</code> に外部からアクセス可能なホスト名(IP アドレスなど)を指定してください。</p>
<p>オプション <code>--target-service</code> には <code>none</code> または <code>nicolive</code> を指定できます。
<code>nicolive</code> が指定された場合、特定の条件で <code>JoinEvent</code> が自動的に送られるなど、ニコニコ生放送に近い挙動で動作します。
詳細はニコ生ゲームのガイド文書 <a href="/guide/shin-ichiba/multi.html#debug">multi モードのゲーム作成</a> を参照してください。</p>
<h2><a name="install"></a> install</h2>
<pre><code class="language-sh">akashic install [&lt;module&gt;]</code></pre>
<p><code>npm install</code> のラッパーコマンドです。</p>
<p><code>&lt;module&gt;</code> を与えた場合、 <code>npm install --save &lt;module&gt;</code> を行い、また導入されたファイルの一覧を game.json に加えます。すなわち次のコマンドと概ね等価な振る舞いをします。</p>
<pre><code class="language-sh">npm install --save &lt;module&gt;
akashic scan globalScripts</code></pre>
<p>@akashic-extension/ で提供される Akashic 向けの拡張機能の他、任意の npm パッケージをゲームに導入することができます。</p>
<blockquote>
<p>注意: Akashic は Node.js のコアモジュール(<code>http</code>, <code>path</code> など)をサポートしていません。コアモジュールに依存しているパッケージを導入した場合、エラーメッセージが表示されます。この場合、<code>npm install</code> は行われ、game.json も更新されますが、ゲームとして実行しようとするとエラーになります。</p>
</blockquote>
<blockquote>
<p>またブラウザ固有の機能や、ECMAScript の一部機能 (<code>Math.random()</code> のような内部状態を持つ機能など) は、
Akashic のゲームとしてはサポートされていません。それらの機能を用いる npm パッケージを導入しないでください。
(akashic コマンド はこれにエラーを出すことはできません。)</p>
</blockquote>
<p>このコマンドは <code>npm install</code> を行うため、game.json と同じディレクトリに package.json という名前のファイルが存在する必要があります。事前に <code>npm init</code> を行うなどの方法で作成してください。
(<code>akashic init</code> が提供するビルトインのテンプレートには含まれています。)</p>
<p><code>&lt;module&gt;</code> を省略した場合、単に <code>npm install</code> を行います。
(package.json に依存生が記録されたパッケージが導入されます。)
game.json は更新されません。package-lock.json がない場合、利用しないでください。
(意図しないバージョンのパッケージが導入される可能性があります。)</p>
<h2><a name="uninstall"></a> uninstall</h2>
<pre><code class="language-sh">akashic uninstall &lt;module&gt;</code></pre>
<p><code>npm uninstall --save &lt;module&gt;</code> を行い、削除されたファイルを game.json から取り除きます。</p>
<p>(install コマンド同様、game.json と同じディレクトリに package.json という名前のファイルが存在する必要があります)</p>
<h2><a name="update"></a> update</h2>
<pre><code class="language-sh">akashic update &lt;module&gt;</code></pre>
<p><code>npm update &lt;module&gt;</code> を行い、./node_modules 以下の npm パッケージを更新します。ファイルの変更は game.json に反映されます。</p>
<p>(install コマンド同様、game.json と同じディレクトリに package.json という名前のファイルが存在する必要があります)</p>
<p><code>&lt;module&gt;</code> を指定しなかった場合、全ての npm パッケージを更新します。npm update の詳細は <a href="https://docs.npmjs.com/cli/update">npm のドキュメント</a> を参照してください。</p>
<h2><a name="export-zip"></a> export zip</h2>
<pre><code class="language-sh">akashic export zip [--output &lt;fileName&gt;]</code></pre>
<p>ゲームディレクトリを zip 形式で圧縮したファイルを <code>&lt;fileName&gt;</code> に出力します。
<code>--output</code> オプションが指定されなかった場合、 <code>./game.zip</code> が指定されたかのように振る舞います。存在するファイル名・ディレクトリ名を指定した場合、エラーになります。</p>
<h2><a name="export-html"></a> export html</h2>
<pre><code class="language-sh">akashic export html --output &lt;dirName&gt; [--bundle] [--minify] [--magnify] [--no-strip]</code></pre>
<p>単独でゲームを実行可能な HTML ファイル (と関連ファイル) を含むディレクトリを出力します。出力されたディレクトリの index.html を Web ブラウザで開くことで、 akashic-sandbox などの動作確認ツールなしにゲームを実行できます。</p>
<p>利用可能なオプションは次のとおりです:</p>
<table>
<thead>
<tr>
<th align="center">オプション</th>
<th align="center">効果</th>
<th align="center">デフォルト値</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>--output &lt;dirName&gt;</code></td>
<td align="center">出力するフォルダを <code>&lt;dirName&gt;</code> にする</td>
<td align="center">N/A</td>
</tr>
<tr>
<td align="center"><code>--bundle</code></td>
<td align="center">スクリプトアセットやテキストアセットなど、可能なものを index.html にまとめる</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--minify</code></td>
<td align="center">スクリプトアセットを minify する</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--magnify</code></td>
<td align="center">ゲーム画面をブラウザのウィンドウサイズに合わせて拡縮するようにする</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--inject &lt;fileName&gt;</code></td>
<td align="center">出力 HTML の head 要素に <code>&lt;fileName&gt;</code> の内容を含める</td>
<td align="center">指定なし</td>
</tr>
<tr>
<td align="center"><code>--no-strip</code></td>
<td align="center">ゲーム実行に不要なファイルを出力から除外しない</td>
<td align="center">指定なし</td>
</tr>
</tbody></table>
<p><code>--inject</code> オプション(<code>akashic-cli@1.3.1</code> で導入)は複数指定可能です。指定した順でファイルの内容が出力されます。ディレクトリ名も指定でき、その場合はディレクトリ内の全ファイルが出力されます(順不同)。</p>
<p><code>--output</code> オプションに存在するファイル名・ディレクトリ名を指定した場合、エラーになります。またゲームのディレクトリ以下のパスを指定することはできません。たとえば game.json のあるディレクトリで次のように指定するとエラーになります。</p>
<pre><code class="language-sh">$ akashic export html --output ./bundled  # エラー</code></pre>
<p><code>./bundled</code> ではなく <code>../bundled</code> にするなど、ゲームのディレクトリの外を指定してください。この場合、 <code>../bundled/index.html</code> を Web ブラウザで開くと、単独でゲームを実行できます。
(ゲーム実行には <code>../bundled/</code> 以下のファイルがすべて必要である点に注意してください)</p>
<pre><code class="language-sh">$ akashic export html --output ../bundled</code></pre>
<h2><a name="stat"></a> stat</h2>
<pre><code class="language-sh">akashic stat &lt;target&gt; [options...]</code></pre>
<p><code>&lt;target&gt;</code> で指定された内容に関して情報を収集して出力します。現在 <code>&lt;target&gt;</code> に与えられるのは <code>size</code> のみです。</p>
<h3><a name="ゲームの容量計算 (size)"></a> ゲームの容量計算 (size)</h3>
<p><code>&lt;target&gt;</code> に <code>size</code> を指定すると、ゲームの容量を計算します。ゲームの容量とはゲームを配信する際にネットワーク通信が必要なコンテンツのファイルサイズの合計のことです。</p>
<p>何もオプションを付けずに実行した場合、以下のように表示されます。</p>
<pre><code class="language-sh">$ akashic stat size
image: 415.49KB (84%)
text: 25.60KB (5%)
ogg audio: 47.74KB
mp4 audio: 53.02KB (11%)
aac audio: 52.71KB
script: 641B (0%)
other: 1.44KB (0%)
  game.json: 1.44KB
[ ] TOTAL SIZE (using ogg): 490.90KB (502685B)
[*] TOTAL SIZE (using mp4): 496.19KB (508096B)
[ ] TOTAL SIZE (using aac): 495.87KB (507775B)</code></pre>
<p>オーディオは mp4 と aac と ogg のうち合計容量が大きいものを利用して計算します。結果表示の <code>(87%)</code> の部分は全体用量に占めるそのカテゴリのファイルの割合を示しています。
<code>game.json</code>, <code>node_moduels/</code> 以下のスクリプトは <code>other</code> に分類されます。</p>
<p><code>--limit</code> オプションが指定されると、ゲームの容量が指定された値を超えた場合にエラーと表示され、コマンド自体の戻り値が正常終了時の <code>0</code> ではなく <code>1</code> になります。</p>
<p>容量は <code>--limit 100KB</code> のように指定します。<code>1KB</code> は <code>1024B</code> として計算されます。単位として、<code>B</code>, <code>KB</code>, <code>MB</code>, <code>GB</code> が利用でき、末尾の <code>B</code> は省略できます。</p>
<p><code>--raw</code> オプションが指定されると、以下のように合計容量のバイト数のみを表示して終了します。</p>
<pre><code class="language-sh">$ akashic stat size --raw
1657274</code></pre>
<h2><a name="initで作られるファイル"></a> init で作られるファイル</h2>
<h3><a name="imageディレクトリ"></a> image ディレクトリ</h3>
<p>画像素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は png/jpg であり、拡張子と画像フォーマットは一致している必要があります。それ以外の拡張子のファイル、または &quot;.&quot; から始まるファイルは無視されます。</p>
<h3><a name="textディレクトリ"></a> text ディレクトリ</h3>
<p>テキスト素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は特に指定がないため、 &quot;.&quot; から始まるファイル以外はすべて取り込まれます。
<em>取り込まれないファイルを指定する方法は検討中。</em></p>
<h3><a name="audioディレクトリ"></a> audio ディレクトリ</h3>
<p>音楽、効果音など、音素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は ogg と aac であり、拡張子とファイルフォーマットは一致している必要があります。それ以外の拡張子のファイル、または &quot;.&quot; から始まるファイルは無視されます。</p>
<p>他の素材と異なり、音素材は、ファイル名の拡張子部分のみが異なる複数のファイルをまとめて取り扱います。それら (audio/foo.ogg と audio/foo.aac など) は同一の内容であることが期待されます。これはゲームの実行環境に応じて適切な形式を選択し利用するためです。</p>
<h3><a name="scriptディレクトリ"></a> script ディレクトリ</h3>
<p>スクリプト素材を配置するディレクトリ。</p>
<p>サポートされる拡張子は.js と.json であり、拡張子とファイルフォーマットは一致している必要があります。それ以外の拡張子のファイル、または &quot;.&quot; から始まるファイルは無視されます。</p>
<p>慣習として、各 Scene を実装するファイルは、このディレクトリ内に
&quot;Scene.js&quot; という接尾辞をつけて配置される事が推奨されます（例: titleScene.js, battleScene.js）。</p>
<h3><a name="main.js"></a> main.js ファイル</h3>
<p>ゲームの処理が記述されているファイル。</p>
<p>このファイルを編集することによってゲームを作成することが可能です。</p>
<h3><a name="_bootstrap.js"></a> _bootstrap.js ファイル</h3>
<p><code>--type javascript-shin-ichiba-ranking</code> を指定した時(もしくは <code>--type typescript-shin-ichiba-ranking</code> を指定後ビルドした時)のみ作られるファイルです。
このファイルがエントリーポイントとなりますが、ゲーム開発者がこのファイルを編集することは基本的にありません。
ここで行っていることは、以下の通りです。</p>
<ul>
<li>セッションパラメータの取得</li>
<li>ゲームが動作している環境が RPG アツマール上かどうかの判定</li>
<li>main.js に自動的に遷移</li>
</ul>
<h3><a name="game.jsonファイル"></a> game.json ファイル</h3>
<p>ゲームの各種情報を記述するファイル。</p>
<p><code>akashic init --type javascript-minimal</code> を実行した直後は以下のような内容になっています。
(ただし width, height, fps は init で指定した値)</p>
<pre><code class="language-json">{
  &quot;width&quot;: 480,
  &quot;height&quot;: 480,
  &quot;fps&quot;: 30,
  &quot;assets&quot;: {
    &quot;mainScene&quot;: {
      &quot;type&quot;: &quot;script&quot;,
      &quot;path&quot;: &quot;script/main.js&quot;,
      &quot;global&quot;: true
    }
  }
}</code></pre>
<p>詳細な仕様は<a href="game-json.html">game.json の仕様</a>を参照してください。</p>
<h2><a name="Node.js 開発者向けの追加情報"></a> Node.js 開発者向けの追加情報</h2>
<p>akashic は、install, uninstall コマンドを除き、package.json に関知しません。</p>
<p>ゲーム開発者は、npm install --save-dev jasmine して spec ディレクトリにテストを配置するなど、任意の開発フローを(Akashic のディレクトリ構成と衝突するなどの問題がない限り)とることができます。</p>

		</div>
	</section>
	<footer class="safearea--LR">
	<div class="responsive--width">

		<ul class="foot--creativecommons">
			<li class="foot--creativecommons--ban"><a href="http://creativecommons.org/licenses/by/2.1/jp/" target="_blank"><img alt="クリエイティブ・コモンズ・ライセンス" src="https://i.creativecommons.org/l/by/2.1/jp/80x15.png"></a></li>
			<li class="foot--creativecommons--txt">このサイトの画像は、一部を除き <a rel="license" href="http://creativecommons.org/licenses/by/2.1/jp/" target="_blank">クリエイティブ・コモンズ 表示 2.1 日本 ライセンス</a><br>の下に提供されています: <a href="/image-license.html">詳細</a></li>
		</ul>

		<ul class="foot--license">
			<li class="foot--license--akashic"><a href="https://akashic-games.github.io"></a></li>
			<li class="foot--license--dwango"><a href="http://dwango.co.jp" target="_blank">&copy; dwango</a></li>
		</ul>

	</div>
</footer>

</div>
<div class="page--top"></div>
<div class="window--dark"></div>

<script>
	// リサイズ時にコンテンツのリサイズができない状態なので暫定対応でコンテンツをリロードしている
	// TODO: リサイズ時にコンテンツも追従する仕組みを作成する
	window.addEventListener('resize', function() {
		var iframes = document.getElementsByClassName('akashic-content');
		var contents = Array.prototype.slice.call(iframes);
		contents.forEach(function(content) {
			content.contentWindow.location.reload(true);
		});
	});
</script>
</body>
</html>
